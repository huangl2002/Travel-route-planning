# 地图功能测试指南

## 快速开始

### 1. 启动项目

```bash
npm run dev
```

项目将在 `http://localhost:3000/` 启动。

### 2. 配置API密钥（重要！）

**在测试前，必须先配置高德地图API密钥：**

1. 打开 `src/config/amap.js`
2. 找到 `key: 'YOUR_AMAP_KEY'`
3. 替换为您的高德地图API密钥
4. 保存文件

**获取API密钥：**
- 访问 https://console.amap.com/
- 注册/登录账号
- 创建应用并获取Web端(JS API)的Key
- 开发环境可设置安全域名为 `*` 或 `localhost`

## 测试步骤

### 测试1：地图组件加载

1. 访问 `http://localhost:3000/`
2. 点击导航栏的"路线规划"
3. 观察地图区域：
   - ✓ 应该显示加载动画
   - ✓ 几秒后应该显示高德地图
   - ✓ 地图应该可以拖拽和缩放
   - ✓ 应该显示比例尺和工具栏控件

**预期结果：** 地图正常加载并显示中国地图

### 测试2：添加目的地

1. 在"路线规划"页面
2. 在"添加目的地"输入框中输入"北京"
3. 点击"添加"按钮
4. 观察地图：
   - ✓ 地图上应该显示北京的标记
   - ✓ 标记应该有编号"1"
   - ✓ 标记应该有标签显示"1. 北京"

5. 继续添加"上海"、"广东"
6. 观察地图：
   - ✓ 应该显示3个标记
   - ✓ 标记之间应该有虚线连接
   - ✓ 地图应该自动调整视野以显示所有标记

**预期结果：** 所有目的地正确显示，路线正确连接

### 测试3：保存和查看路线

1. 在"路线规划"页面：
   - 输入路线名称："春节旅行"
   - 设置出行日期：选择未来日期
   - 添加备注："家庭旅行"
   - 点击"保存路线"
   - ✓ 应该显示"路线保存成功!"提示

2. 点击"我的路线"
3. 点击刚才保存的路线"春节旅行"
4. 观察地图：
   - ✓ 应该显示完整的路线
   - ✓ 右侧应该显示目的地列表
   - ✓ 点击目的地列表中的项目，地图应该聚焦到该位置

**预期结果：** 路线保存成功，查看时正确显示

### 测试4：删除目的地

1. 在"路线规划"页面
2. 添加多个目的地
3. 点击目的地列表中的"×"按钮删除某个目的地
4. 观察地图：
   - ✓ 被删除的标记应该消失
   - ✓ 路线应该重新绘制
   - ✓ 标记编号应该自动更新

**预期结果：** 删除功能正常，地图实时更新

### 测试5：响应式布局

1. 在桌面浏览器中调整窗口大小
2. 观察地图：
   - ✓ 地图应该自适应容器大小
   - ✓ 布局应该保持合理

3. 使用开发者工具切换到移动设备视图
4. 观察布局：
   - ✓ 应该切换为垂直布局
   - ✓ 地图应该在上方，目的地列表在下方
   - ✓ 所有功能应该仍然可用

**预期结果：** 响应式布局正常工作

### 测试6：边界情况测试

#### 测试6.1：无效目的地

1. 尝试添加不存在的省份名称，如"火星"
2. 观察结果：
   - ✓ 应该不会在地图上显示标记
   - ✓ 不应该出现错误

#### 测试6.2：重复目的地

1. 添加两次同一个目的地，如"北京"
2. 观察结果：
   - ✓ 应该显示两个标记
   - ✓ 路线应该正确连接

#### 测试6.3：清空所有目的地

1. 添加多个目的地
2. 逐个删除所有目的地
3. 观察地图：
   - ✓ 应该显示空状态提示
   - ✓ 不应该显示任何标记或路线

**预期结果：** 边界情况处理正确

## 测试检查清单

### 功能测试
- [ ] 地图正常加载
- [ ] 可以添加目的地
- [ ] 可以删除目的地
- [ ] 可以保存路线
- [ ] 可以查看已保存的路线
- [ ] 可以删除路线
- [ ] 目的地列表点击聚焦功能正常
- [ ] 地图拖拽和缩放正常

### 界面测试
- [ ] 加载动画显示正常
- [ ] 地图控件显示正常
- [ ] 标记样式正确
- [ ] 路线样式正确
- [ ] 响应式布局正常

### 错误处理
- [ ] API密钥未配置时显示错误
- [ ] 网络错误时显示错误提示
- [ ] 无效目的地处理正确
- [ ] 控制台无错误信息

## 常见问题排查

### 问题1：地图显示空白

**可能原因：**
- API密钥未配置或配置错误
- 网络连接问题
- 安全域名配置不正确

**解决方法：**
1. 检查 `src/config/amap.js` 中的 `key` 是否正确
2. 打开浏览器控制台查看错误信息
3. 确认高德开放平台的安全域名配置

### 问题2：目的地不显示

**可能原因：**
- 目的地名称不在支持列表中
- 坐标获取失败

**解决方法：**
1. 确认目的地名称是否正确（支持省份全称和简称）
2. 查看浏览器控制台是否有错误
3. 检查 `provinceCoordinates` 中是否包含该目的地

### 问题3：路线不显示

**可能原因：**
- 目的地数量少于2个
- 坐标获取失败

**解决方法：**
1. 确认至少添加了2个目的地
2. 确认所有目的地都能正确获取坐标

### 问题4：地图无法拖拽或缩放

**可能原因：**
- CSS样式冲突
- JavaScript错误

**解决方法：**
1. 检查浏览器控制台是否有JavaScript错误
2. 检查是否有CSS样式影响地图容器

## 性能测试

### 测试多个目的地

1. 添加10个不同的目的地
2. 观察性能：
   - ✓ 地图应该流畅运行
   - ✓ 标记应该快速显示
   - ✓ 路线应该正确绘制

### 测试频繁操作

1. 快速添加和删除目的地
2. 观察性能：
   - ✓ 不应该出现卡顿
   - ✓ 地图应该实时更新

## 浏览器兼容性测试

请在以下浏览器中测试：

- [ ] Chrome (最新版)
- [ ] Firefox (最新版)
- [ ] Safari (最新版)
- [ ] Edge (最新版)
- [ ] 移动端浏览器 (iOS Safari, Android Chrome)

## 测试报告模板

```
测试日期：____年__月__日
测试人员：__________
测试环境：__________

测试结果：
✓ 通过的测试：____个
✗ 失败的测试：____个

发现的问题：
1. _______________________
2. _______________________
3. _______________________

建议改进：
1. _______________________
2. _______________________
3. _______________________
```

## 下一步

测试完成后，可以考虑：

1. 添加更多目的地（城市级别）
2. 集成地理编码API
3. 添加路线规划功能
4. 优化地图样式
5. 添加更多交互功能

---

**注意：**
- 所有测试都需要在配置好API密钥后进行
- 测试过程中注意查看浏览器控制台的错误信息
- 如发现问题，请记录详细的复现步骤
